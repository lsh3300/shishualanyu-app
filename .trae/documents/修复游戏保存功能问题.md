## 问题分析

### 1. POST /api/inventory/save-recent 500错误
- **原因**：API中使用了`.single()`方法，当没有找到记录时会抛出错误
- **影响**：自动保存到最近创作功能失败
- **位置**：`save-recent/route.ts`第45行和第70行

### 2. "保存到背包"按钮功能问题
- **现状**：按钮点击后没有明显的API调用反馈
- **可能原因**：
  - API调用失败
  - 提示显示不明显
  - 按钮状态管理问题

## 修复计划

### 1. 修复save-recent API 500错误
- **文件**：`app/api/inventory/save-recent/route.ts`
- **修改**：将第45行和第70行的`.single()`改为`.maybeSingle()`，避免找不到记录时抛出错误
- **目的**：确保API调用成功，自动保存功能正常工作

### 2. 优化"保存到背包"功能
- **检查**：`ScoreResultDialog.tsx`中的`handleSaveToInventory`函数
- **确保**：API调用参数正确
- **优化**：添加更明显的状态反馈（如按钮加载状态）
- **验证**：确保toast提示正常显示

### 3. 增强错误处理
- **添加**：更详细的错误日志，便于调试
- **改进**：更友好的用户错误提示
- **确保**：所有API调用都有适当的错误处理

### 4. 测试验证
- **运行**：开发服务器
- **测试**：自动保存功能
- **验证**："保存到背包"功能
- **检查**：所有提示是否正常显示

## 预期效果
1. save-recent API不再返回500错误
2. 自动保存功能正常工作
3. "保存到背包"按钮有明显的状态反馈
4. 所有API操作都有清晰的提示
5. 游戏保存功能完全可用