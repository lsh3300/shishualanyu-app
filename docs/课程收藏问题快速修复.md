# 课程收藏问题 - 快速修复

## ⚠️ 问题

从终端日志可以看到：
```
❌ 添加收藏失败: {
  code: '23503',
  message: 'insert or update on table "favorites" violates foreign key constraint "favorites_course_id_fkey"'
}
插入数据: {
  course_id: '00000000-0000-0000-0000-000000000001'
}
```

**原因**: 课程 ID `00000000-0000-0000-0000-000000000001` 不存在于数据库中。

---

## ✅ 解决方法（仅需 2 步）

### 第 1 步：执行修复脚本 ⭐

1. 登录 [Supabase Dashboard](https://supabase.com/dashboard)
2. 进入 **SQL Editor**
3. 点击 **New query**
4. 复制粘贴 `supabase/fix-courses-seed.sql` 的内容
5. 点击 **Run** 执行

**脚本会做什么？**
- ✅ 添加缺失的字段
- ✅ 插入 8 门标准课程
- ✅ 使用 `ON CONFLICT` 避免重复数据

---

### 第 2 步：验证修复

在 Supabase SQL Editor 执行：

```sql
-- 检查课程数量
SELECT COUNT(*) FROM courses;
-- 应该返回至少 8

-- 查看课程列表
SELECT id, title, category FROM courses ORDER BY id;
```

---

## 🧪 测试

1. 刷新页面：`http://localhost:3000/teaching`
2. 点击任意课程的收藏按钮 ❤️
3. ✅ 应该成功，不再报错

---

## 📋 课程列表

修复后将包含以下课程：

| 课程 | 分类 | 价格 |
|------|------|------|
| 传统扎染基础入门课程 | 扎染 | 免费 |
| 扎染进阶技法与创作 | 扎染 | ¥168 |
| 现代扎染艺术创作 | 扎染 | ¥198 |
| 扎染工艺与商业应用 | 扎染 | ¥128 |
| 蜡染工艺基础入门 | 蜡染 | ¥199 |
| 传统苗族蜡染技法 | 蜡染 | ¥258 |
| 蜡染纹样设计与应用 | 蜡染 | ¥178 |
| 蜡染与扎染结合创作 | 综合 | ¥238 |

---

## 📚 相关文档

- **详细指南**: `课程收藏失败修复指南.md`
- **修复脚本**: `supabase/fix-courses-seed.sql`
- **常见问题**: `README.md` 第 8 条

---

**完成时间**: 2025-11-22  
**预计修复时间**: 3 分钟  
**状态**: ✅ 解决方案已准备
