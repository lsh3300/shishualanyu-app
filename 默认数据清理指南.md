# 默认数据清理指南

## 概述

本文档总结了世说蓝语应用中默认数据清理的经验和最佳实践，为后续开发和维护提供参考。

## 已完成的清理工作

### 1. 首页默认数据清理
- **文件**: `app/page.tsx`
- **清理内容**: 移除了硬编码的推荐课程和产品数据
- **结果**: 首页现在显示空状态，等待API实现

### 2. 个人资料页面默认数据清理
- **文件**: `app/profile/page.tsx`
- **清理内容**: 移除了硬编码的用户统计信息
- **结果**: 个人资料页面现在显示空状态，等待API实现

### 3. 订单、课程、收藏和作业页面默认数据清理
- **文件**: 
  - `app/profile/orders/page.tsx`
  - `app/profile/courses/page.tsx`
  - `app/profile/favorites/page.tsx`
  - `app/profile/assignments/page.tsx`
- **清理内容**: 移除了各页面中的硬编码默认数据
- **结果**: 所有页面现在正确显示空状态

### 4. 消息通知系统默认数据清理
- **文件**: 
  - `hooks/use-messages.ts`
  - `hooks/use-notifications.ts`
  - `components/ui/notification-popover.tsx`
  - `hooks/use-global-state.ts`
  - `components/ui/mini-profile-popover.tsx`
- **清理内容**: 
  - 移除了消息和通知的默认数据
  - 更新了全局状态中的未读计数（从3和2改为0）
  - 修复了相关组件中的硬编码引用
- **结果**: 消息和通知系统现在正确显示空状态

## 关键发现和经验

### 1. 默认数据分布广泛
默认数据不仅存在于页面组件中，还分布在：
- 自定义Hook中（如use-messages.ts、use-notifications.ts）
- 全局状态管理中（use-global-state.ts）
- UI组件中（notification-popover.tsx、mini-profile-popover.tsx）

### 2. 数据引用关系复杂
清理默认数据时需要注意：
- 组件间的数据传递关系
- 全局状态与局部状态的同步
- 硬编码值与动态值的区分

### 3. 空状态处理的重要性
清理默认数据后，必须确保：
- 页面有适当的空状态UI
- 加载状态和错误状态的处理
- 用户友好的提示信息

## 最佳实践

### 1. 默认数据管理
- 避免在组件中硬编码默认数据
- 使用统一的API或服务层管理数据
- 考虑使用环境变量区分开发/生产环境的数据策略

### 2. 全局状态管理
- 确保全局状态与实际数据同步
- 避免在全局状态中设置固定的初始值
- 提供重置状态的方法

### 3. 组件设计
- 设计组件时考虑空状态、加载状态和错误状态
- 使用条件渲染处理不同状态
- 提供有意义的反馈信息

### 4. 测试策略
- 测试空状态下的UI表现
- 验证数据加载和错误处理
- 确保用户体验的一致性

## 后续工作建议

### 1. API集成
- 实现后端API替换当前的空数据
- 确保API返回的数据结构与前端期望一致
- 添加适当的错误处理和重试机制

### 2. 数据持久化
- 实现用户数据的本地存储策略
- 考虑离线场景下的数据处理
- 实现数据同步机制

### 3. 用户体验优化
- 添加骨架屏提升加载体验
- 实现数据预加载策略
- 优化空状态的用户引导

### 4. 开发流程
- 建立代码审查流程，防止新的默认数据引入
- 创建自动化测试验证空状态
- 文档化数据管理规范

## 注意事项

1. **环境区分**: 开发环境可能需要一些默认数据用于测试，但生产环境应该完全依赖API
2. **数据一致性**: 确保清理默认数据后，各相关组件的数据引用保持一致
3. **性能考虑**: 空状态下的组件渲染性能也需要关注
4. **可维护性**: 保持代码的可读性和可维护性，为后续功能扩展留出空间

## 相关文件清单

### 已修改的文件
- `app/page.tsx`
- `app/profile/page.tsx`
- `app/profile/orders/page.tsx`
- `app/profile/courses/page.tsx`
- `app/profile/favorites/page.tsx`
- `app/profile/assignments/page.tsx`
- `hooks/use-messages.ts`
- `hooks/use-notifications.ts`
- `hooks/use-global-state.ts`
- `components/ui/notification-popover.tsx`
- `components/ui/mini-profile-popover.tsx`

### 待实现API的文件
- `app/api/messages/`
- `app/api/notifications/`
- `app/api/user/`

## 结论

通过系统性的清理工作，我们移除了应用中的所有硬编码默认数据，确保了新用户注册后的干净体验。这一工作为后续的API集成和功能开发奠定了良好的基础。

在未来的开发中，应该遵循本文档中的最佳实践，避免引入不必要的默认数据，保持应用的灵活性和可维护性。